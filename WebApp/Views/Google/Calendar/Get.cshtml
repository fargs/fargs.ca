@using Features = Orvosi.Shared.Enums.Features
@using WebApp.Library.Extensions
@using Orvosi.Data
@model Google.Apis.Calendar.v3.Data.Event

@{
    var features = User.Identity.GetFeatures();
    var db = DependencyResolver.Current.GetService<OrvosiDbContext>();
    var timeZones = db.TimeZones;
}

@if (features.Contains(Features.ServiceRequest_Google.OpenInGoogle))
{
    <div>
        <i class="fa fa-check fa-2x text-success"></i> <small><a target="_blank" href="@Model.HtmlLink">Open in Google Calendar</a></small>
    </div>
    <div class="well well-sm">
        <div>
            @Model.Summary
        </div>
        <strong>When</strong>
        <div>
            @Model.Start.DateTime.Value.ToTimeZoneIana(Model.Start.TimeZone, timeZones)
            <small class="text-muted">@Model.Start.TimeZone</small>
        </div>
        <strong>Where</strong>
        <div>
            @Model.Location
        </div>
        <strong>Attendees</strong>
        @if (Model.Attendees.Count <= 0)
        {
            <div>No attendees yet</div>
        }
        else
        {
            <ul>
                @foreach (var item in Model.Attendees)
                {
                    <li>@item.Email (@item.ResponseStatus)</li>
                }
            </ul>
        }
    </div>
}
